#!/bin/bash
sort -k1,1 -k2n,2n -k3n,3n -k4,4 -k5,5 -k6,6 -T /tmp/ /home/kevbrick/data/SSDS_Pipeline/callPeaks/git/unitTest/dmc1SSDS_CHSdemo.chstestgenome.ssDNA_type1.bed |uniq >/tmp/dmc1SSDS_CHSdemo.chstestgenome.ssDNA_type1.uniq.bed
sort -k1,1 -k2n,2n -k3n,3n -k4,4 -k5,5 -k6,6 -T /tmp/ /home/kevbrick/data/SSDS_Pipeline/callPeaks/git/unitTest/IgG_SSDS_CHSdemo.chstestgenome.ssDNA_type1.bed |uniq >/tmp/IgG_SSDS_CHSdemo.chstestgenome.ssDNA_type1.uniq.bed
R --vanilla </tmp//SSDSpl_tmp_29981526041/CHS_NCIS_512363496041995.R
ratio=`perl /home/kevbrick/data/SSDS_Pipeline/callPeaks/git//getNCISratio.pl /home/kevbrick/data/SSDS_Pipeline/callPeaks/git/unitTest/output/callHotspotsTest.NCISout`
python2.7 /home/kevbrick/data/SSDS_Pipeline/callPeaks/git/macs2.1.0.20150420/bin//macs2 callpeak --ratio $ratio -g 30000000 -t /tmp/dmc1SSDS_CHSdemo.chstestgenome.ssDNA_type1.uniq.bed -c /tmp/IgG_SSDS_CHSdemo.chstestgenome.ssDNA_type1.uniq.bed --bw 1000 --keep-dup all --slocal 5000 --name /home/kevbrick/data/SSDS_Pipeline/callPeaks/git/unitTest/output/callHotspotsTest >/home/kevbrick/data/SSDS_Pipeline/callPeaks/git/unitTest/output/callHotspotsTest.macs2callpeak.170605_154418.OUT 2>/home/kevbrick/data/SSDS_Pipeline/callPeaks/git/unitTest/output/callHotspotsTest.macs2callpeak.170605_154418.ERR
cut -f1-3 /home/kevbrick/data/SSDS_Pipeline/callPeaks/git/unitTest/output/callHotspotsTest_peaks.narrowPeak |grep -v ^M |grep -v chrM |sort -k1,1 -k2n,2n >/home/kevbrick/data/SSDS_Pipeline/callPeaks/git/unitTest/output/callHotspotsTest_peaks.bed
perl /home/kevbrick/data/SSDS_Pipeline/callPeaks/git//calcStrengthAndRecenterHotspots.pl --hs /home/kevbrick/data/SSDS_Pipeline/callPeaks/git/unitTest/output/callHotspotsTest_peaks.bed --frag /home/kevbrick/data/SSDS_Pipeline/callPeaks/git/unitTest/dmc1SSDS_CHSdemo.chstestgenome.ssDNA_type1.bed --v --out /home/kevbrick/data/SSDS_Pipeline/callPeaks/git/unitTest/output/callHotspotsTest_peaks.bedgraph 
